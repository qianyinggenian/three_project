"use strict";(self["webpackChunkthree_project"]=self["webpackChunkthree_project"]||[]).push([[111],{7588:function(e,t,n){var i=n(46518),o=n(69565),a=n(72652),s=n(79306),r=n(28551),d=n(1767),l=n(9539),h=n(84549),c=h("forEach",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:c},{forEach:function(e){r(this);try{s(e)}catch(i){l(this,"throw",i)}if(c)return o(c,this,e);var t=d(this),n=0;a(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}})},97111:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"upload-container"},[t("div",{staticClass:"tabs-box"},e._l(e.tabs,(function(n,i){return t("div",{key:i,staticClass:"tab",class:e.activeTab===n.value?"active-tab":"",on:{click:function(t){return e.handleClickTab(n)}}},[e._v(" "+e._s(n.label))])})),0),"动态"===e.activeTab?t("el-upload",{attrs:{action:"","before-upload":e.handlePreview}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("上传文件")])],1):e._e(),t("span",{staticClass:"fileName"},[e._v("模型名称："+e._s(e.fileName))])],1),t("div",{ref:"webglRef",staticClass:"three-container",attrs:{id:"webgl-output"}})])},o=[],a=(n(44114),n(18111),n(7588),n(68964)),s=n(17024),r=n(61728),d=n(22004),l=n(17888),h=n(74788);let c,p,u,m,f,g,C,w;var y={name:"index",components:{},data(){return{tabs:[{label:"默认",value:"默认"},{label:"动态",value:"动态"}],scene:null,controls:null,webglRef:null,fileName:"洪奇沥大桥.gltf",activeTab:"默认"}},props:{},watch:{},computed:{},mounted(){"默认"===this.activeTab&&this.init()},methods:{handleClickTab(e){this.activeTab=e.value,this.cleanupScene(),this.destroyGUI(),"默认"===this.activeTab&&this.$nextTick((()=>{this.init()}))},init(){if(!p){const e=this.$refs.webglRef;p=new a.Z58,u=new a.ubm(55,e.clientWidth/e.clientHeight,1,2e4),c=new a.JeP({antialias:!0,logarithmicDepthBuffer:!0}),c.setClearColor(new a.Q1f(8900331)),c.setSize(e.clientWidth,e.clientHeight),c.setPixelRatio(window.devicePixelRatio),c.physicallyCorrectLights=!0,c.outputEncoding=a.S2Q,c.shadowMap.enabled=!0,u.position.set(125.7512205654842,57.58951477003565,701.0900594107068),u.lookAt(p.position),e.appendChild(c.domElement),c.render(p,u)}this.addControls(),this.addAxesHelper(),this.addBridge(),this.addAmbientLight(),this.addDirectionalLight(),this.initGUI(),this.$nextTick((()=>{this.render()}))},render(){m&&m.update(),c&&c.render(p,u),requestAnimationFrame(this.render)},addBridge(){const e=new r.Z,t=(0,d.s)("/static/draco/gltf/","three_project");e.setDecoderPath(t);const n=new l.B;let i;n.setDRACOLoader(e),i="动态"===this.activeTab?this.previewPath:(0,d.s)("/static/digital/models/大桥.gltf","three_project"),n.load(i,(function(e){const t=e.scene;p.add(t)}),void 0,(function(e){console.error(e)}))},addControls(){m=new s.N(u,c.domElement),m.target.set(0,0,0)},addAxesHelper(){const e=new a.IzY(2e4);p.add(e);const t=new a.mrM({color:16750721}),n=[];n.push(new a.Pq0(0,0,0)),n.push(new a.Pq0(-2e3,0,0));const i=(new a.LoY).setFromPoints(n),o=new a.N1A(i,t);p.add(o);const s=new a.mrM({color:474509}),r=[];r.push(new a.Pq0(0,0,0)),r.push(new a.Pq0(0,0,-2e3));const d=(new a.LoY).setFromPoints(r),l=new a.N1A(d,s);p.add(l)},addAmbientLight(){C=new a.$p8(15644036),C.position.set(0,1e3,500),p.add(C)},addDirectionalLight(){f=new a.ZyN(15644036,10),f.position.set(300,-100,300),g=new a.ZyN(15644036,10),g.position.set(10,250,-500),p.add(f),p.add(g)},handlePreview(e){this.fileName=e.name;const t=new FileReader;return t.onload=async e=>{this.previewPath=e.target.result,this.cleanupScene(),this.destroyGUI(),await this.init()},t.readAsDataURL(e),!1},initGUI(){w=new h.cL;const e=w.addFolder("Camera Position");e.add(u.position,"x",-5e4,5e4).name("Position X").step(.01).onChange(this.render),e.add(u.position,"y",-5e4,5e4).name("Position Y").step(.01).onChange(this.render),e.add(u.position,"z",-5e4,5e4).name("Position Z").step(.01).onChange(this.render),e.open();const t=w.addFolder("Camera Target"),n=new a.Pq0;m.target.copy(n),t.add(n,"x",-5e4,5e4).name("Target X").step(.01).onChange((()=>{m.target.copy(n),m.update(),this.render()})),t.add(n,"y",-5e4,5e4).name("Target Y").step(.01).onChange((()=>{m.target.copy(n),m.update(),this.render()})),t.add(n,"z",-5e4,5e4).name("Target Z").step(.01).onChange((()=>{m.target.copy(n),m.update(),this.render()})),t.open();const i=w.addFolder("Directional Light 1"),o={color:"#ffeeff"};i.addColor(o,"color").name("Color").onChange((e=>{f.color.set(e),this.render()})),i.add(f.position,"x",-5e4,5e4).name("Position X").step(.1).onChange(this.render),i.add(f.position,"y",-5e4,5e4).name("Position Y").step(.1).onChange(this.render),i.add(f.position,"z",-5e4,5e4).name("Position Z").step(.1).onChange(this.render),i.add(f,"intensity",0,20).name("Intensity").step(.1).onChange(this.render),i.open();const s=w.addFolder("Directional Light 2"),r={color:"#ffffff"};s.addColor(r,"color").name("Color").onChange((e=>{g.color.set(e),this.render()})),s.add(g.position,"x",-5e4,5e4).name("Position X").step(.1).onChange(this.render),s.add(g.position,"y",-5e4,5e4).name("Position Y").step(.1).onChange(this.render),s.add(g.position,"z",-5e4,5e4).name("Position Z").step(.1).onChange(this.render),s.add(g,"intensity",0,20).name("Intensity").step(.1).onChange(this.render),s.open();const d=w.addFolder("Ambient Light"),l={color:"#ffffee"};d.addColor(l,"color").name("Color").onChange((e=>{C.color.set(e),this.render()})),d.add(C,"intensity",0,20).name("Intensity").step(.1).onChange(this.render),d.open()},cleanupScene(){c&&(c.dispose(),c.forceContextLoss(),c.domElement.remove(),c=null),p&&(p.traverse((e=>{e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach((e=>e.dispose())):e.material.dispose()),e.texture&&e.texture.dispose()})),p=null),u&&(u=null),m&&(m.dispose(),m=null)},onWindowResize(){u.aspect=this.$refs.threeContainer.clientWidth/this.$refs.threeContainer.clientHeight,u.updateProjectionMatrix(),c.setSize(this.$refs.threeContainer.clientWidth,this.$refs.threeContainer.clientHeight),this.render()},destroyGUI(){w&&(w.destroy(),w=null)}},beforeDestroy(){this.cleanupScene(),this.destroyGUI()}},b=y,v=n(81656),P=(0,v.A)(b,i,o,!1,null,"2ab7ec93",null),x=P.exports}}]);
//# sourceMappingURL=111.79d296fc.js.map